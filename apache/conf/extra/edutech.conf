<VirtualHost *:80>
    ServerName javier.local
    ServerAlias *.javier.local
    Redirect permanent / https://pruebas.javier.local/
</VirtualHost>

<VirtualHost *:443>
    ServerName produccion.javier.local
    DocumentRoot "/usr/local/apache2/htdocs/produccion"

    SSLEngine on
    SSLCertificateFile "/usr/local/apache2/conf/ssl/server.crt"
    SSLCertificateKeyFile "/usr/local/apache2/conf/ssl/server.key"

    <Directory "/usr/local/apache2/htdocs/produccion">
        AllowOverride All
        Options Indexes FollowSymLinks
        Require all granted
    </Directory>

    ErrorLog "/usr/local/apache2/logs/produccion_error.log"
    CustomLog "/usr/local/apache2/logs/produccion_access.log" combined
</VirtualHost>

<VirtualHost *:443>
    ServerName pruebas.javier.local
    DocumentRoot "/usr/local/apache2/htdocs/pruebas"

    SSLEngine on
    SSLCertificateFile "/usr/local/apache2/conf/ssl/server.crt"
    SSLCertificateKeyFile "/usr/local/apache2/conf/ssl/server.key"

    ErrorLog "/usr/local/apache2/logs/pruebas_error.log"
    CustomLog "/usr/local/apache2/logs/pruebas_access.log" common

    <Directory "/usr/local/apache2/htdocs/pruebas">
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>
</VirtualHost>

<VirtualHost *:443>
    ServerName tomcat.javier.local
    
    SSLEngine on
    SSLCertificateFile "/usr/local/apache2/conf/ssl/server.crt"
    SSLCertificateKeyFile "/usr/local/apache2/conf/ssl/server.key"

    ProxyRequests Off
    ProxyPreserveHost On
    
    ProxyPass / http://tomcat:8080/
    ProxyPassReverse / http://tomcat:8080/
    
    ErrorLog "/usr/local/apache2/logs/tomcat_error.log"
    CustomLog "/usr/local/apache2/logs/tomcat_access.log" combined
</VirtualHost>